{% extends 'layout.html' %}


{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


{% comment %} <p>{{moviepage.title}}</p> {% endcomment %}
{% comment %} <img src="/media/{{moviepage.detail_img}}" alt=""> {% endcomment %}
{% comment %} <h1>{{ moviepage.header }}</h1>
<p>{{ moviepage.text }}</p>
<p>Рейтинг: {{ moviepage.average_rating }}</p>
<p>Ваша оценка: {{ moviepage.user_rating }}</p> {% endcomment %}

<div class="row titleMovie">
    <div class="col-6 image d-flex justify-content-center">
        <img src="/media/{{moviepage.img_detail}}" class="rounded shadow img-fluid" alt="Movie Poster">
    </div>
    <div class="col-6">
        <h3 class="text">{{moviepage.title}}</h3>
        <h5>Жанр: {{moviepage.genre}}</h1>
        <div class="container" style="padding: 5px">
            <h5 class="card-title">
                <span class="fa fa-star {% if moviepage.average_rating > 0 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 1 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 2 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 3 %} checked {% endif %}" ></span>
                <span class="fa fa-star {% if moviepage.average_rating > 4 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 5 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 6 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 7 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 8 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 9 %} checked {% endif %}"></span>
                <label class="rounded">{{moviepage.average_rating|floatformat:0 }}</label>

            </h5>
            <p>Оцените фильм</p>
            <ul class="btn btn-light list-inline rating-list">
                <li onclick="rate(10, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 9 %} checked {% endif %}" title="Rate 10"></i></li>
                <li onclick="rate(9, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 8 %} checked {% endif %}" title="Rate 9"></i></li>
                <li onclick="rate(8, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 7 %} checked {% endif %}" title="Rate 8"></i></li>
                <li onclick="rate(7, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 6 %} checked {% endif %}" title="Rate 7"></i></li>
                <li onclick="rate(6, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 5 %} checked {% endif %}" title="Rate 6"></i></li>
                <li onclick="rate(5, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 4 %} checked {% endif %}" title="Rate 5"></i></li>
                <li onclick="rate(4, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 3 %} checked {% endif %}" title="Rate 4"></i></li>
                <li onclick="rate(3, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 2 %} checked {% endif %}" title="Rate 3"></i></li>
                <li onclick="rate(2, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 1 %} checked {% endif %}" title="Rate 2"></i></li>
                <li onclick="rate(1, {{ moviepage.url }})">
                    <i class="fa fa-star {% if moviepage.user_rating > 0 %} checked {% endif %}" title="Rate 1"></i></li>
                
            </ul>
        </div>
    </div>
</div>
<div class="desript">
    <p>Описание: {{moviepage.description}}</p>
</div>
<hr>
<h5>Сеансы на сегодня</h5>
{% for hall in halls %}
    <div class="cinema-info">
        <h4>{{ hall.cinema.cinema }}</h4>
    </div>
    <ul class="showtimes">
        {% for show in hall.show_movie.all %}
            <li>{{ show.time_show }}</li>
        {% endfor %}
    </ul>
{% endfor %}




{% comment %} <div class="container" style="padding: 2em">
    <h5 class="card-title">Avg rating:
        <span class="fa fa-star {% if moviepage.average_rating > 0 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 1 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 2 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 3 %} checked {% endif %}" ></span>
        <span class="fa fa-star {% if moviepage.average_rating > 4 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 5 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 6 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 7 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 8 %} checked {% endif %}"></span>
        <span class="fa fa-star {% if moviepage.average_rating > 9 %} checked {% endif %}"></span>
    </h5>
    <ul class="btn btn-light list-inline rating-list">
        <li onclick="rate(10, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 9 %} checked {% endif %}" title="Rate 10"></i></li>
        <li onclick="rate(9, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 8 %} checked {% endif %}" title="Rate 9"></i></li>
        <li onclick="rate(8, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 7 %} checked {% endif %}" title="Rate 8"></i></li>
        <li onclick="rate(7, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 6 %} checked {% endif %}" title="Rate 7"></i></li>
        <li onclick="rate(6, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 5 %} checked {% endif %}" title="Rate 6"></i></li>
        <li onclick="rate(5, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 4 %} checked {% endif %}" title="Rate 5"></i></li>
        <li onclick="rate(4, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 3 %} checked {% endif %}" title="Rate 4"></i></li>
        <li onclick="rate(3, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 2 %} checked {% endif %}" title="Rate 3"></i></li>
        <li onclick="rate(2, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 1 %} checked {% endif %}" title="Rate 2"></i></li>
        <li onclick="rate(1, {{ moviepage.url }})">
            <i class="fa fa-star {% if moviepage.user_rating > 0 %} checked {% endif %}" title="Rate 1"></i></li>
    </ul>
</div> {% endcomment %}

<script>
    const rate = (rating, movie_id) => {
        fetch(`/movie/${movie_id}/rate/${rating}/`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(rest => {
            window.location.reload();
            // you may want to update the rating here
            // to simplify stuff, I just reload the page
        })
    }
</script>

<style>
    .ellipsis {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        max-width: 100%; 
        background-color: orange;
      }
      
    .titleMovie {
        padding: 10px;
    }
</style>



<style>
    .rating-list li {
      float: right;
      color: #ddd;
      padding: 10px 5px;
    }

    .rating-list li:hover,
    .rating-list li:hover ~ li {
      color: orange;
    }

    .rating-list {
      display: inline-block;
      list-style: none;
    }
    .checked {
        color: orange;
    }
</style>

{% endblock content %}
