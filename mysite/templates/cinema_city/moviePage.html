{% extends 'layout.html' %}


{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<p>{{moviepage.title}}</p>
{% comment %} <img src="/media/{{moviepage.detail_img}}" alt=""> {% endcomment %}


<h1>{{ moviepage.header }}</h1>
<p>{{ moviepage.text }}</p>
<p>Рейтинг: {{ moviepage.average_rating }}</p>
<p>Ваша оценка: {{ moviepage.user_rating }}</p>


    <div class="container" style="padding: 2em">
    

            <h5 class="card-title">Avg rating:
                <span class="fa fa-star {% if moviepage.average_rating > 0 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 1 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 2 %} checked {% endif %}"></span>
                <span class="fa fa-star {% if moviepage.average_rating > 3 %} checked {% endif %}" ></span>
                <span class="fa fa-star {% if moviepage.average_rating > 4 %} checked {% endif %}"></span>
            </h5>
            <ul class="btn btn-light list-inline rating-list">
              <li onclick="rate(5, {{ moviepage.url }})">
                  <i class="fa fa-star {% if moviepage.user_rating > 4 %} checked {% endif %}" title="Rate 5"></i></li>
              <li onclick="rate(4, {{ moviepage.url }})">
                  <i class="fa fa-star {% if moviepage.user_rating > 3 %} checked {% endif %}" title="Rate 4"></i></li>
              <li onclick="rate(3, {{ moviepage.url }})">
                  <i class="fa fa-star {% if moviepage.user_rating > 2 %} checked {% endif %}" title="Rate 3"></i></li>
              <li onclick="rate(2, {{ moviepage.url }})">
                  <i class="fa fa-star {% if moviepage.user_rating > 1 %} checked {% endif %}" title="Rate 2"></i></li>
              <li onclick="rate(1, {{ moviepage.url }})">
                  <i class="fa fa-star {% if moviepage.user_rating > 0 %} checked {% endif %}" title="Rate 1"></i></li>
            </ul>

    </div>


    <script>
        const rate = (rating, movie_id) => {
            fetch(`/movie/${movie_id}/rate/${rating}/`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(rest => {
                window.location.reload();
                // you may want to update the rating here
                // to simplify stuff, I just reload the page
            })
        }
    </script>

<style>
    .rating-list li {
      float: right;
      color: #ddd;
      padding: 10px 5px;
    }

    .rating-list li:hover,
    .rating-list li:hover ~ li {
      color: orange;
    }

    .rating-list {
      display: inline-block;
      list-style: none;
    }
    .checked {
        color: orange;
    }
</style>

{% endblock content %}
